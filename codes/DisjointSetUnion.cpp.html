<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 

  <!-- link rel="stylesheet" href="http://acm.math.spbu.ru/~sk1/colorer1/xcode.css">
  <script src="http://acm.math.spbu.ru/~sk1/colorer1/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script -->

  <link rel="stylesheet" title="Default" href="http://acm.math.spbu.ru/~sk1/colorer/my.css">
  <script src="http://acm.math.spbu.ru/~sk1/colorer/highlight.js"></script>
  <script src="http://acm.math.spbu.ru/~sk1/colorer/cpp.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>

<body>

<pre><code>
/*
 * DisjointSetUnion.cpp
 *
 *  Created on: Mar 30, 2015
 *      Author: dima
 */

#include &lt;bits/stdc++.h&gt;

const int N = int(1e5);

int p[N];
int rnk[N];

void makeSet(int x) {
    p[x] = x;
    rnk[x] = 0;
}

int findSet(int x) {
    return x == p[x] ? x : p[x] = findSet(p[x]);
}

void unionSets(int x, int y) {
    x = findSet(x);
    y = findSet(y);

    if (x == y) return;

    p[y] = x;

    if (rnk[x] &lt; rnk[y]) {
        std::swap(x, y);
    }

    p[y] = x;

    if (rnk[x] == rnk[y]) {
        rnk[x]++;
    }
}

int main() {
    int n;
    scanf("%d", &n);

    for (int i = 0; i &lt; n; i++) {
        makeSet(i);
    }

    int q;
    scanf("%d", &q);

    for (int i = 0; i &lt; q; i++) {
        char c;
        int v, u;
        scanf(" %c%d%d", &c, &v, &u);

        if (c == '+') {
            unionSets(v, u);
        } else if (c == '?') {
            findSet(v) == findSet(u) ? puts("Yes") : puts("No");
        }
    }
}

</code></pre>

</body>
</html>

<font style="visibility:hidden">
